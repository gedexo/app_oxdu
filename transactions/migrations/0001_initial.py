# Generated by Django 4.2 on 2026-01-10 11:08

from decimal import Decimal
from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion
import django.utils.timezone
import simple_history.models


class Migration(migrations.Migration):

    initial = True

    dependencies = [migrations.swappable_dependency(settings.AUTH_USER_MODEL), ('accounting', '0001_initial'), ('branches', '0001_initial')]

    operations = [
        migrations.CreateModel(
            name='Transaction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(choices=[(True, 'Yes'), (False, 'No')], default=True, verbose_name='Mark as Active')),
                (
                    'transaction_type',
                    models.CharField(
                        choices=[
                            ('course_fee', 'Course Fee'),
                            ('payroll', 'Payroll'),
                            ('sale_invoice', 'Sale Invoice'),
                            ('sale_order', 'Sale Order'),
                            ('sale_return', 'Sale Return'),
                            ('credit_note', 'Credit Note'),
                            ('purchase_invoice', 'Purchase Invoice'),
                            ('purchase_order', 'Purchase Order'),
                            ('purchase_return', 'Purchase Return'),
                            ('debit_note', 'Debit Note'),
                            ('receipt', 'Receipt'),
                            ('payment', 'Payment'),
                            ('journal_voucher', 'Journal Voucher'),
                            ('income', 'Income'),
                            ('expense', 'Expense'),
                            ('opening_balance', 'Opening Balance'),
                            ('opening_stock', 'Opening Stock'),
                            ('stock_adjustment', 'Stock Adjustment'),
                            ('stock_transfer', 'Stock Transfer'),
                            ('contra', 'Contra Voucher'),
                            ('stakeholder_investment', 'Stakeholder Investment'),
                            ('stakeholder_withdrawal', 'Stakeholder Withdrawal'),
                        ],
                        db_index=True,
                        max_length=30,
                    ),
                ),
                (
                    'status',
                    models.CharField(
                        choices=[
                            ('draft', 'Draft'),
                            ('posted', 'Posted'),
                            ('cancelled', 'Cancelled'),
                            ('pending_approval', 'Pending Approval'),
                            ('approved', 'Approved'),
                            ('rejected', 'Rejected'),
                        ],
                        db_index=True,
                        default='draft',
                        max_length=20,
                    ),
                ),
                ('priority', models.CharField(choices=[('low', 'Low'), ('normal', 'Normal'), ('high', 'High'), ('urgent', 'Urgent')], default='normal', max_length=10)),
                ('voucher_number', models.CharField(blank=True, db_index=True, max_length=50, null=True)),
                ('is_double_entry', models.BooleanField(default=False)),
                ('external_reference', models.CharField(blank=True, help_text='PO number / External reference', max_length=100, null=True)),
                ('date', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                (
                    'payment_term',
                    models.CharField(
                        blank=True,
                        choices=[
                            ('IMMEDIATE', 'Immediate Payment'),
                            ('7D', '7 Days'),
                            ('15D', '15 Days'),
                            ('30D', '30 Days'),
                            ('45D', '45 Days'),
                            ('60D', '60 Days'),
                            ('90D', '90 Days'),
                        ],
                        max_length=20,
                        null=True,
                    ),
                ),
                ('due_date', models.DateField(blank=True, null=True)),
                ('delivery_date', models.DateField(blank=True, null=True)),
                ('reference', models.CharField(blank=True, max_length=100, null=True)),
                ('narration', models.TextField(blank=True, null=True)),
                ('remark', models.TextField(blank=True, null=True)),
                ('attachment', models.FileField(blank=True, null=True, upload_to='transactions/')),
                ('invoice_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15)),
                ('received_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15)),
                ('balance_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15)),
                ('outstanding_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15)),
                ('outstanding_type', models.CharField(choices=[('DR', 'DR'), ('CR', 'CR')], default='DR', max_length=2)),
                ('total_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15)),
                ('branch', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='branches.branch')),
                (
                    'creator',
                    models.ForeignKey(
                        blank=True,
                        editable=False,
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name='%(app_label)s_%(class)s_creator',
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={'ordering': ['-created'], 'abstract': False},
        ),
        migrations.CreateModel(
            name='ContraVoucher',
            fields=[
                ('created', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(choices=[(True, 'Yes'), (False, 'No')], default=True, verbose_name='Mark as Active')),
                ('transaction', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, primary_key=True, serialize=False, to='transactions.transaction')),
                (
                    'amount',
                    models.DecimalField(decimal_places=2, help_text='Transfer amount', max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))]),
                ),
                ('cheque_number', models.CharField(blank=True, max_length=50, null=True, verbose_name='Cheque/Reference Number')),
                ('cheque_date', models.DateField(blank=True, null=True, verbose_name='Cheque/Transaction Date')),
                ('bank_name', models.CharField(blank=True, max_length=100, null=True, verbose_name='Bank Name')),
                ('is_denomination', models.BooleanField(default=False)),
                ('denomination_500', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹500 Notes')),
                ('denomination_200', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹200 Notes')),
                ('denomination_100', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹100 Notes')),
                ('denomination_50', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹50 Notes')),
                ('denomination_20', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹20 Notes')),
                ('denomination_10', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹10 Notes')),
                ('denomination_5', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹5 Coins')),
                ('denomination_2', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹2 Coins')),
                ('denomination_1', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹1 Coins')),
                (
                    'transaction_mode',
                    models.CharField(
                        blank=True,
                        choices=[('cheque', 'Cheque'), ('dd', 'Demand Draft'), ('neft', 'NEFT'), ('rtgs', 'RTGS'), ('imps', 'IMPS'), ('upi', 'UPI'), ('cash', 'Cash')],
                        default='cash',
                        max_length=20,
                        null=True,
                    ),
                ),
            ],
            options={'ordering': ['-transaction__date', '-created']},
        ),
        migrations.CreateModel(
            name='TransactionEntry',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(choices=[(True, 'Yes'), (False, 'No')], default=True, verbose_name='Mark as Active')),
                ('debit_amount', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('credit_amount', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('description', models.TextField(blank=True, null=True)),
                ('account', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='accounting.account')),
                (
                    'creator',
                    models.ForeignKey(
                        blank=True,
                        editable=False,
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name='%(app_label)s_%(class)s_creator',
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                ('transaction', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='entries', to='transactions.transaction')),
            ],
            options={'verbose_name_plural': 'Transaction Entries'},
        ),
        migrations.CreateModel(
            name='IncomeExpense',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated', models.DateTimeField(auto_now=True)),
                ('type', models.CharField(choices=[('income', 'Income'), ('expense', 'Expense')], db_index=True, max_length=10)),
                ('amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Amount of the income or expense', max_digits=15)),
                (
                    'payment_method',
                    models.CharField(
                        blank=True,
                        choices=[('cash', 'Cash'), ('bank', 'Bank Transfer'), ('Razorpay', 'Razorpay')],
                        help_text='Method of payment received/spent',
                        max_length=50,
                        null=True,
                    ),
                ),
                ('reference_number', models.CharField(blank=True, help_text='Reference number for the transaction', max_length=100, null=True)),
                ('description', models.TextField(blank=True, help_text='Detailed description of the income or expense', null=True)),
                ('date', models.DateTimeField(db_index=True, default=django.utils.timezone.now, help_text='Date of the income or expense transaction')),
                ('attachment', models.FileField(blank=True, help_text='Supporting document for the transaction', null=True, upload_to='income_expense/')),
                ('is_active', models.BooleanField(default=True)),
                (
                    'branch',
                    models.ForeignKey(
                        blank=True, help_text='Branch associated with this income/expense', null=True, on_delete=django.db.models.deletion.CASCADE, to='branches.branch'
                    ),
                ),
                (
                    'category',
                    models.ForeignKey(
                        blank=True,
                        help_text='Income or expense category account',
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name='income_expense_category',
                        to='accounting.account',
                    ),
                ),
                (
                    'creator',
                    models.ForeignKey(
                        blank=True,
                        editable=False,
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name='%(app_label)s_%(class)s_creator',
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    'party',
                    models.ForeignKey(
                        blank=True,
                        help_text='Cash or bank account for the transaction',
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name='income_expenses',
                        to='accounting.account',
                    ),
                ),
                ('transaction', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='income_expense_detail', to='transactions.transaction')),
            ],
            options={'verbose_name': 'Income/Expense', 'verbose_name_plural': 'Income/Expenses', 'ordering': ['-date']},
        ),
        migrations.CreateModel(
            name='HistoricalTransactionEntry',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('created', models.DateTimeField(blank=True, db_index=True, editable=False)),
                ('updated', models.DateTimeField(blank=True, editable=False)),
                ('is_active', models.BooleanField(choices=[(True, 'Yes'), (False, 'No')], default=True, verbose_name='Mark as Active')),
                ('debit_amount', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('credit_amount', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('description', models.TextField(blank=True, null=True)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                (
                    'account',
                    models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='accounting.account'),
                ),
                (
                    'creator',
                    models.ForeignKey(
                        blank=True, db_constraint=False, editable=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL
                    ),
                ),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                (
                    'transaction',
                    models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='transactions.transaction'),
                ),
            ],
            options={
                'verbose_name': 'historical transaction entry',
                'verbose_name_plural': 'historical Transaction Entries',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalTransaction',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('created', models.DateTimeField(blank=True, db_index=True, editable=False)),
                ('updated', models.DateTimeField(blank=True, editable=False)),
                ('is_active', models.BooleanField(choices=[(True, 'Yes'), (False, 'No')], default=True, verbose_name='Mark as Active')),
                (
                    'transaction_type',
                    models.CharField(
                        choices=[
                            ('course_fee', 'Course Fee'),
                            ('payroll', 'Payroll'),
                            ('sale_invoice', 'Sale Invoice'),
                            ('sale_order', 'Sale Order'),
                            ('sale_return', 'Sale Return'),
                            ('credit_note', 'Credit Note'),
                            ('purchase_invoice', 'Purchase Invoice'),
                            ('purchase_order', 'Purchase Order'),
                            ('purchase_return', 'Purchase Return'),
                            ('debit_note', 'Debit Note'),
                            ('receipt', 'Receipt'),
                            ('payment', 'Payment'),
                            ('journal_voucher', 'Journal Voucher'),
                            ('income', 'Income'),
                            ('expense', 'Expense'),
                            ('opening_balance', 'Opening Balance'),
                            ('opening_stock', 'Opening Stock'),
                            ('stock_adjustment', 'Stock Adjustment'),
                            ('stock_transfer', 'Stock Transfer'),
                            ('contra', 'Contra Voucher'),
                            ('stakeholder_investment', 'Stakeholder Investment'),
                            ('stakeholder_withdrawal', 'Stakeholder Withdrawal'),
                        ],
                        db_index=True,
                        max_length=30,
                    ),
                ),
                (
                    'status',
                    models.CharField(
                        choices=[
                            ('draft', 'Draft'),
                            ('posted', 'Posted'),
                            ('cancelled', 'Cancelled'),
                            ('pending_approval', 'Pending Approval'),
                            ('approved', 'Approved'),
                            ('rejected', 'Rejected'),
                        ],
                        db_index=True,
                        default='draft',
                        max_length=20,
                    ),
                ),
                ('priority', models.CharField(choices=[('low', 'Low'), ('normal', 'Normal'), ('high', 'High'), ('urgent', 'Urgent')], default='normal', max_length=10)),
                ('voucher_number', models.CharField(blank=True, db_index=True, max_length=50, null=True)),
                ('is_double_entry', models.BooleanField(default=False)),
                ('external_reference', models.CharField(blank=True, help_text='PO number / External reference', max_length=100, null=True)),
                ('date', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                (
                    'payment_term',
                    models.CharField(
                        blank=True,
                        choices=[
                            ('IMMEDIATE', 'Immediate Payment'),
                            ('7D', '7 Days'),
                            ('15D', '15 Days'),
                            ('30D', '30 Days'),
                            ('45D', '45 Days'),
                            ('60D', '60 Days'),
                            ('90D', '90 Days'),
                        ],
                        max_length=20,
                        null=True,
                    ),
                ),
                ('due_date', models.DateField(blank=True, null=True)),
                ('delivery_date', models.DateField(blank=True, null=True)),
                ('reference', models.CharField(blank=True, max_length=100, null=True)),
                ('narration', models.TextField(blank=True, null=True)),
                ('remark', models.TextField(blank=True, null=True)),
                ('attachment', models.TextField(blank=True, max_length=100, null=True)),
                ('invoice_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15)),
                ('received_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15)),
                ('balance_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15)),
                ('outstanding_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15)),
                ('outstanding_type', models.CharField(choices=[('DR', 'DR'), ('CR', 'CR')], default='DR', max_length=2)),
                ('total_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('branch', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='branches.branch')),
                (
                    'creator',
                    models.ForeignKey(
                        blank=True, db_constraint=False, editable=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL
                    ),
                ),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical transaction',
                'verbose_name_plural': 'historical transactions',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalIncomeExpense',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('created', models.DateTimeField(blank=True, db_index=True, editable=False)),
                ('updated', models.DateTimeField(blank=True, editable=False)),
                ('type', models.CharField(choices=[('income', 'Income'), ('expense', 'Expense')], db_index=True, max_length=10)),
                ('amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Amount of the income or expense', max_digits=15)),
                (
                    'payment_method',
                    models.CharField(
                        blank=True,
                        choices=[('cash', 'Cash'), ('bank', 'Bank Transfer'), ('Razorpay', 'Razorpay')],
                        help_text='Method of payment received/spent',
                        max_length=50,
                        null=True,
                    ),
                ),
                ('reference_number', models.CharField(blank=True, help_text='Reference number for the transaction', max_length=100, null=True)),
                ('description', models.TextField(blank=True, help_text='Detailed description of the income or expense', null=True)),
                ('date', models.DateTimeField(db_index=True, default=django.utils.timezone.now, help_text='Date of the income or expense transaction')),
                ('attachment', models.TextField(blank=True, help_text='Supporting document for the transaction', max_length=100, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                (
                    'branch',
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text='Branch associated with this income/expense',
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name='+',
                        to='branches.branch',
                    ),
                ),
                (
                    'category',
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text='Income or expense category account',
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name='+',
                        to='accounting.account',
                    ),
                ),
                (
                    'creator',
                    models.ForeignKey(
                        blank=True, db_constraint=False, editable=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL
                    ),
                ),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                (
                    'party',
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text='Cash or bank account for the transaction',
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name='+',
                        to='accounting.account',
                    ),
                ),
                (
                    'transaction',
                    models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='transactions.transaction'),
                ),
            ],
            options={
                'verbose_name': 'historical Income/Expense',
                'verbose_name_plural': 'historical Income/Expenses',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalContraVoucher',
            fields=[
                ('created', models.DateTimeField(blank=True, db_index=True, editable=False)),
                ('updated', models.DateTimeField(blank=True, editable=False)),
                ('is_active', models.BooleanField(choices=[(True, 'Yes'), (False, 'No')], default=True, verbose_name='Mark as Active')),
                (
                    'amount',
                    models.DecimalField(decimal_places=2, help_text='Transfer amount', max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))]),
                ),
                ('cheque_number', models.CharField(blank=True, max_length=50, null=True, verbose_name='Cheque/Reference Number')),
                ('cheque_date', models.DateField(blank=True, null=True, verbose_name='Cheque/Transaction Date')),
                ('bank_name', models.CharField(blank=True, max_length=100, null=True, verbose_name='Bank Name')),
                ('is_denomination', models.BooleanField(default=False)),
                ('denomination_500', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹500 Notes')),
                ('denomination_200', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹200 Notes')),
                ('denomination_100', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹100 Notes')),
                ('denomination_50', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹50 Notes')),
                ('denomination_20', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹20 Notes')),
                ('denomination_10', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹10 Notes')),
                ('denomination_5', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹5 Coins')),
                ('denomination_2', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹2 Coins')),
                ('denomination_1', models.PositiveIntegerField(blank=True, null=True, verbose_name='₹1 Coins')),
                (
                    'transaction_mode',
                    models.CharField(
                        blank=True,
                        choices=[('cheque', 'Cheque'), ('dd', 'Demand Draft'), ('neft', 'NEFT'), ('rtgs', 'RTGS'), ('imps', 'IMPS'), ('upi', 'UPI'), ('cash', 'Cash')],
                        default='cash',
                        max_length=20,
                        null=True,
                    ),
                ),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                (
                    'creator',
                    models.ForeignKey(
                        blank=True, db_constraint=False, editable=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL
                    ),
                ),
                (
                    'from_account',
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text='Source account (Cash/Bank)',
                        limit_choices_to={'under__locking_group__in': ['CASH_ACCOUNT', 'BANK_ACCOUNT']},
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name='+',
                        to='accounting.account',
                    ),
                ),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                (
                    'to_account',
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text='Destination account (Cash/Bank)',
                        limit_choices_to={'under__locking_group__in': ['CASH_ACCOUNT', 'BANK_ACCOUNT']},
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name='+',
                        to='accounting.account',
                    ),
                ),
                (
                    'transaction',
                    models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='transactions.transaction'),
                ),
            ],
            options={
                'verbose_name': 'historical contra voucher',
                'verbose_name_plural': 'historical contra vouchers',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.AddIndex(model_name='transactionentry', index=models.Index(fields=['transaction', 'account'], name='transaction_transac_487dfb_idx')),
        migrations.AddIndex(model_name='transactionentry', index=models.Index(fields=['account', 'debit_amount'], name='transaction_account_7c1dc1_idx')),
        migrations.AddIndex(model_name='transactionentry', index=models.Index(fields=['account', 'credit_amount'], name='transaction_account_72b29c_idx')),
        migrations.AddConstraint(
            model_name='transactionentry',
            constraint=models.CheckConstraint(check=models.Q(('debit_amount__gt', 0), ('credit_amount__gt', 0), _negated=True), name='not_both_debit_and_credit'),
        ),
        migrations.AddConstraint(
            model_name='transactionentry',
            constraint=models.CheckConstraint(check=models.Q(('debit_amount__gt', 0), ('credit_amount__gt', 0), _connector='OR'), name='entry_has_amount'),
        ),
        migrations.AddConstraint(model_name='transactionentry', constraint=models.CheckConstraint(check=models.Q(('debit_amount__gte', 0)), name='debit_amount_non_negative')),
        migrations.AddConstraint(model_name='transactionentry', constraint=models.CheckConstraint(check=models.Q(('credit_amount__gte', 0)), name='credit_amount_non_negative')),
        migrations.AddIndex(model_name='incomeexpense', index=models.Index(fields=['type', 'date'], name='transaction_type_870fc0_idx')),
        migrations.AddIndex(model_name='incomeexpense', index=models.Index(fields=['party'], name='transaction_party_i_86d484_idx')),
        migrations.AddIndex(model_name='incomeexpense', index=models.Index(fields=['category'], name='transaction_categor_0fda87_idx')),
        migrations.AddIndex(model_name='incomeexpense', index=models.Index(fields=['branch'], name='transaction_branch__f76222_idx')),
        migrations.AddField(
            model_name='contravoucher',
            name='creator',
            field=models.ForeignKey(
                blank=True, editable=False, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(app_label)s_%(class)s_creator', to=settings.AUTH_USER_MODEL
            ),
        ),
        migrations.AddField(
            model_name='contravoucher',
            name='from_account',
            field=models.ForeignKey(
                help_text='Source account (Cash/Bank)',
                limit_choices_to={'under__locking_group__in': ['CASH_ACCOUNT', 'BANK_ACCOUNT']},
                on_delete=django.db.models.deletion.PROTECT,
                related_name='contra_from',
                to='accounting.account',
            ),
        ),
        migrations.AddField(
            model_name='contravoucher',
            name='to_account',
            field=models.ForeignKey(
                help_text='Destination account (Cash/Bank)',
                limit_choices_to={'under__locking_group__in': ['CASH_ACCOUNT', 'BANK_ACCOUNT']},
                on_delete=django.db.models.deletion.PROTECT,
                related_name='contra_to',
                to='accounting.account',
            ),
        ),
        migrations.AddIndex(model_name='contravoucher', index=models.Index(fields=['from_account', 'to_account'], name='transaction_from_ac_001571_idx')),
        migrations.AddIndex(model_name='contravoucher', index=models.Index(fields=['transaction'], name='transaction_transac_eb011c_idx')),
        migrations.AddConstraint(
            model_name='contravoucher', constraint=models.CheckConstraint(check=models.Q(('from_account', models.F('to_account')), _negated=True), name='contra_different_accounts')
        ),
        migrations.AddConstraint(model_name='contravoucher', constraint=models.CheckConstraint(check=models.Q(('amount__gt', 0)), name='contra_amount_positive')),
    ]
