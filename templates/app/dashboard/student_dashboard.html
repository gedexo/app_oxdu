    {% load static extras %}

    {% block extra_css%}
    <style>
        /* Global Styles */
        body {
            background: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* Banner Slider Styles */
        .banner-section {
            margin-top: 20px;
            margin-bottom: 30px;
        }

        .banner-slider {
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        .banner-slide {
            position: relative;
            height: 550px;
            background: linear-gradient(135deg, #ee4c24, #eb135e);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            padding: 40px;
        }

        .banner-content {
            text-align: center;
            z-index: 2;
        }

        .banner-content h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .banner-content p {
            font-size: 1.2rem;
            opacity: 0.95;
        }

        .banner-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.1);
            z-index: 1;
        }

        /* Carousel Controls */
        .carousel-control-prev, .carousel-control-next {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0.8;
            transition: all 0.3s ease;
        }

        .carousel-control-prev:hover, .carousel-control-next:hover {
            background: rgba(255,255,255,0.5);
            opacity: 1;
        }

        .carousel-indicators {
            margin-bottom: 15px;
        }

        .carousel-indicators button {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: rgba(255,255,255,0.6);
            border: none;
            margin: 0 5px;
        }

        .carousel-indicators button.active {
            background-color: white;
        }

        /* Navigation Cards */
        .nav-cards-section {
            margin-bottom: 40px;
            margin-top: 40px;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 25px;
            position: relative;
            padding-left: 15px;
        }

        .section-title::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 5px;
            height: 25px;
            background: linear-gradient(180deg, #ee4c24, #eb135e);
            border-radius: 5px;
        }

        .nav-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border: none;
            height: 100%;
            cursor: pointer;
            text-decoration: none;
            display: block;
            position: relative;
            overflow: hidden;
        }

        .nav-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ee4c24, #eb135e);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .nav-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }

        .nav-card:hover::before {
            transform: scaleX(1);
        }

        .nav-card-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 28px;
            color: white;
            background: linear-gradient(135deg, #ee4c24, #eb135e);
            box-shadow: 0 5px 15px rgba(238, 76, 36, 0.3);
        }

        .nav-card-title {
            font-size: 1rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .nav-card-subtitle {
            font-size: 0.85rem;
            color: #7f8c8d;
        }

        /* Attendance Section */
        .attendance-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }

        .attendance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }

        .date-time-badges {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .date-time-badge {
            background: linear-gradient(135deg, #ee4c24, #eb135e);
            color: white;
            padding: 8px 16px;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 500;
            box-shadow: 0 3px 10px rgba(238, 76, 36, 0.3);
        }

        .attendance-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: flex-end;
        }

        .legend-item {
            padding: 6px 14px;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .legend-item i {
            font-size: 14px;
        }

        /* Table Styles */
        .custom-table {
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .custom-table thead {
            color: white;
        }

        .custom-table thead th {
            padding: 15px 10px !important;
            font-weight: 600;
            border: none;
            text-align: center;
            font-size: 0.9rem;
        }

        .custom-table tbody td {
            padding: 12px 10px !important;
            vertical-align: middle;
            border-color: #f0f0f0;
        }

        .custom-table tbody tr:hover {
            background-color: #f8f9fa;
            transition: background-color 0.2s ease;
        }

        .custom-table tbody .attendance-th, 
        .custom-table tbody .attendance-td, 
        .custom-table thead .attendance-th, 
        .custom-table thead .attendance-td {
            padding: .75rem !important;
            line-height: 0.462 !important;
        }

        .custom-table tfoot {
            background: #f8f9fa;
            font-weight: 600;
        }

        .custom-table tfoot td {
            padding: 15px 10px !important;
            border-top: 2px solid #dee2e6;
        }

        /* Status Colors */
        .bg-success-transparent {
            background-color: rgba(40, 199, 111, 0.15) !important;
            border: 1px solid rgba(40, 199, 111, 0.3);
        }

        .bg-warning-transparent {
            background-color: rgba(255, 193, 7, 0.15) !important;
            border: 1px solid rgba(255, 193, 7, 0.3);
        }

        .bg-primary-transparent {
            background-color: rgba(13, 110, 253, 0.15) !important;
            border: 1px solid rgba(13, 110, 253, 0.3);
        }

        .bg-danger-transparent {
            background-color: rgba(220, 53, 69, 0.15) !important;
            border: 1px solid rgba(220, 53, 69, 0.3);
        }

        .text-success { color: #28a745 !important; }
        .text-warning { color: #ffc107 !important; }
        .text-danger { color: #dc3545 !important; }
        .text-primary { color: #0d6efd !important; }

        /* Modal Styles */
        .modal-content {
            border: none;
            border-radius: 20px;
        }

        .modal-header {
            border-top-left-radius: 20px;
            border-top-right-radius: 20px;
            border-bottom: none;
            padding: 20px 25px;
        }

        .modal-body {
            padding: 25px;
        }

        .carousel-indicators [data-bs-target]{
            height: 2px !important;
        }
        .bg-success { background: linear-gradient(135deg, #28a745, #20c997) !important; }
        .bg-warning { background: linear-gradient(135deg, #ffc107, #ff9800) !important; }
        .bg-danger { background: linear-gradient(135deg, #dc3545, #c82333) !important; }
        .bg-secondary { background: linear-gradient(135deg, #6c757d, #5a6268) !important; }

        /* Responsive Styles */
        @media (max-width: 768px) {
            .banner-slide {
                height: 220px;
                padding: 25px;
            }

            .banner-content h1 {
                font-size: 1.8rem;
            }

            .banner-content p {
                font-size: 1rem;
            }

            .attendance-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .attendance-legend {
                justify-content: flex-start;
                width: 100%;
            }

            .section-title {
                font-size: 1.3rem;
            }

            .nav-card-icon {
                width: 50px;
                height: 50px;
                font-size: 24px;
            }

            .nav-card-title {
                font-size: 0.9rem;
            }

            .attendance-section {
                padding: 20px 15px;
            }

            .table-responsive {
                border-radius: 10px;
                overflow-x: auto;
            }

            .custom-table {
                font-size: 0.85rem;
            }

            .custom-table thead th,
            .custom-table tbody td {
                padding: 8px 5px !important;
            }
        }

        @media (max-width: 576px) {
            .banner-section {
                margin-top: 20px;
                margin-bottom: 20px;
            }
            .main-content{
                padding: 0 0 !important;
            }
            .carousel-control-prev, .carousel-control-next{
                display: none !important;
            }

            .banner-slide {
                height: 220px;
                padding: 20px;
            }

            .banner-content h1 {
                font-size: 1.5rem;
            }

            .banner-content p {
                font-size: 0.9rem;
            }

            .date-time-badge {
                font-size: 0.8rem;
                padding: 6px 12px;
            }

            .legend-item {
                font-size: 0.75rem;
                padding: 5px 10px;
            }
        }

        /* Loading Animation */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .nav-card, .attendance-section {
            animation: slideIn 0.5s ease forwards;
        }

        .nav-card:nth-child(1) { animation-delay: 0.1s; }
        .nav-card:nth-child(2) { animation-delay: 0.2s; }
        .nav-card:nth-child(3) { animation-delay: 0.3s; }
        .nav-card:nth-child(4) { animation-delay: 0.4s; }
    </style>
    {% endblock %}

    <div class="app-content">
        <div class="container-fluid">

            {% if hero_banners %}
            <!-- Banner Slider Section -->
            <div class="banner-section">
                <div id="bannerCarousel" class="carousel slide banner-slider" data-bs-ride="carousel">
                    {% if hero_banners %}
                        <div class="carousel-indicators">
                            {% for banner in hero_banners %}
                                <button type="button" data-bs-target="#bannerCarousel" data-bs-slide-to="{{ forloop.counter0 }}" {% if forloop.first %}class="active"{% endif %} aria-label="Slide {{ forloop.counter }}"></button>
                            {% endfor %}
                        </div>
                    {% endif %}
                    
                    <div class="carousel-inner">
                        {% if hero_banners %}
                            {% for banner in hero_banners %}
                            <a {% if banner.url %} href="{{banner.url}}" {% endif %} target="__blank">
                                <div class="carousel-item {% if forloop.first %}active{% endif %}">
                                    <div class="banner-slide" style="background: {% if banner.image %}url('{{ banner.image.url }}') center/cover no-repeat{% else %}linear-gradient(135deg, #ee4c24, #eb135e){% endif %};">
                                        <div class="banner-overlay"></div>
                                        <div class="banner-content">
                                            {% if banner.title %}
                                                <h1>{{ banner.title }}</h1>
                                            {% endif %}
                                            {% if banner.description %}
                                                <p>{{ banner.description }}</p>
                                            {% endif %}
                                            {% if banner.button_text and banner.button_link %}
                                                <a href="{{ banner.button_link }}" class="btn btn-light btn-lg mt-3 px-4 rounded-pill">
                                                    {{ banner.button_text }} <i class="fe fe-arrow-right ms-2"></i>
                                                </a>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </a>
                            {% endfor %}
                        {% else %}
                            <!-- Fallback banners if no hero_banners exist -->
                            <div class="carousel-item active">
                                <div class="banner-slide" style="background: linear-gradient(135deg, #ee4c24, #eb135e);">
                                    <div class="banner-overlay"></div>
                                    <div class="banner-content">
                                        <h1>Welcome Back, {{ user.first_name }}! ðŸ‘‹</h1>
                                        <p>Ready to achieve your learning goals today?</p>
                                    </div>
                                </div>
                            </div>
                            <div class="carousel-item">
                                <div class="banner-slide" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                                    <div class="banner-overlay"></div>
                                    <div class="banner-content">
                                        <h1>Track Your Progress ðŸ“Š</h1>
                                        <p>Stay on top of your attendance and performance</p>
                                    </div>
                                </div>
                            </div>
                            <div class="carousel-item">
                                <div class="banner-slide" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                                    <div class="banner-overlay"></div>
                                    <div class="banner-content">
                                        <h1>Your Success Journey ðŸŽ¯</h1>
                                        <p>Access all your learning resources in one place</p>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                    
                    {% if hero_banners and hero_banners|length > 1 %}
                        <button class="carousel-control-prev" type="button" data-bs-target="#bannerCarousel" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#bannerCarousel" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    {% endif %}
                </div>
            </div>
            {% endif %}

            <!-- Navigation Cards Section -->
            <div class="nav-cards-section">
                <h2 class="section-title">Quick Access</h2>
                <div class="row g-4">
                    <div class="col-6 col-xxl-2 col-xl-3 col-md-3">
                        <a href="{% url 'masters:pdf_book_list' %}" class="nav-card">
                            <div class="nav-card-icon">
                                <i class="la la-file-pdf"></i>
                            </div>
                            <div class="nav-card-title">PDF Books</div>
                            <div class="nav-card-subtitle">Study Materials</div>
                        </a>
                    </div>
                    <div class="col-6 col-xxl-2 col-xl-3 col-md-3">
                        <a href="{% url 'admission:fee_receipt_list' %}" class="nav-card">
                            <div class="nav-card-icon">
                                <i class="la la-file-invoice-dollar"></i>
                            </div>
                            <div class="nav-card-title">Fee Receipt</div>
                            <div class="nav-card-subtitle">Payment History</div>
                        </a>
                    </div>
                    <div class="col-6 col-xxl-2 col-xl-3 col-md-3">
                        <a href="{% url 'admission:fee_overview_list' %}" class="nav-card">
                            <div class="nav-card-icon">
                                <i class="la la-file-invoice"></i>
                            </div>
                            <div class="nav-card-title">Fee Overview</div>
                            <div class="nav-card-subtitle">Fee Summary</div>
                        </a>
                    </div>
                    <div class="col-6 col-xxl-2 col-xl-3 col-md-3">
                        <a href="{% url 'masters:course_syllabus_list' request.user.student.course.pk %}" class="nav-card">
                            <div class="nav-card-icon">
                                <i class="la la-book"></i>
                            </div>
                            <div class="nav-card-title">Syllabus</div>
                            <div class="nav-card-subtitle">Course Content</div>
                        </a>
                    </div>
                    {% comment %} <div class="col-6 col-xxl-2 col-xl-3 col-md-3">
                        <a href="{% url 'masters:feedback_create' %}" class="nav-card">
                            <div class="nav-card-icon">
                                <i class="la la-comment-dots"></i>
                            </div>
                            <div class="nav-card-title">Feedback</div>
                            <div class="nav-card-subtitle">Share Thoughts</div>
                        </a>
                    </div> {% endcomment %}
                    <div class="col-6 col-xxl-2 col-xl-3 col-md-3">
                        <a href="{% url 'masters:leave_request_create' %}" class="nav-card">
                            <div class="nav-card-icon">
                                <i class="la la-plus-circle"></i>
                            </div>
                            <div class="nav-card-title">Leave Request</div>
                            <div class="nav-card-subtitle">Apply Leave</div>
                        </a>
                    </div>
                    <div class="col-6 col-xxl-2 col-xl-3 col-md-3">
                        <a href="{% url 'masters:leave_request_list' %}" class="nav-card">
                            <div class="nav-card-icon">
                                <i class="la la-list-alt"></i>
                            </div>
                            <div class="nav-card-title">My Leaves</div>
                            <div class="nav-card-subtitle">View Status</div>
                        </a>
                    </div>
                    <div class="col-6 col-xxl-2 col-xl-3 col-md-3">
                        <a href="{% url 'masters:employee_chat_list' %}" class="nav-card">
                            <div class="nav-card-icon">
                                <i class="la la-comments"></i>
                            </div>
                            <div class="nav-card-title">Chat</div>
                            <div class="nav-card-subtitle">Connect</div>
                        </a>
                    </div>
                    <div class="col-6 col-xxl-2 col-xl-3 col-md-3">
                        <a href="{% url 'masters:update_list' %}" class="nav-card">
                            <div class="nav-card-icon">
                                <i class="la la-bell"></i>
                            </div>
                            <div class="nav-card-title">Updates</div>
                            <div class="nav-card-subtitle">Latest News</div>
                        </a>
                    </div>
                    <div class="col-6 col-xxl-2 col-xl-3 col-md-3">
                        <a href="{% url 'masters:complaint_create' %}" class="nav-card">
                            <div class="nav-card-icon">
                                <i class="la la-exclamation-triangle"></i>
                            </div>
                            <div class="nav-card-title">Complaint Register</div>
                            <div class="nav-card-subtitle">Submit Issue</div>
                        </a>
                    </div>
                    <div class="col-6 col-xxl-2 col-xl-3 col-md-3">
                        <a href="{% url 'masters:complaint_list' %}" class="nav-card">
                            <div class="nav-card-icon">
                                <i class="la la-clipboard-list"></i>
                            </div>
                            <div class="nav-card-title">My Complaints</div>
                            <div class="nav-card-subtitle">Track Issues</div>
                        </a>
                    </div>
                    <div class="col-6 col-xxl-2 col-xl-3 col-md-3">
                        <a href="{% url 'masters:events' %}" class="nav-card">
                            <div class="nav-card-icon">
                                <i class="la la-calendar-check"></i>
                            </div>
                            <div class="nav-card-title">Events</div>
                            <div class="nav-card-subtitle">Upcoming Activities</div>
                        </a>
                    </div>
                    {% if not is_student_send_placement_request %}
                    <div class="col-6 col-xxl-2 col-xl-3 col-md-3">
                        <a href="{% url 'masters:placement_request_create' %}" class="nav-card">
                            <div class="nav-card-icon">
                                <i class="la la-question-circle"></i>
                            </div>
                            <div class="nav-card-title">Placement Request</div>
                            <div class="nav-card-subtitle">Career Support</div>
                        </a>
                    </div>
                    {% else %}
                    <div class="col-6 col-xxl-2 col-xl-3 col-md-3">
                        <a href="{% url 'masters:placement_request_detail' request.user.student.pk %}" class="nav-card">
                            <div class="nav-card-icon">
                                <i class="la la-question-circle"></i>
                            </div>
                            <div class="nav-card-title">Placement Request View</div>
                            <div class="nav-card-subtitle">Career Support</div>
                        </a>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Attendance Section -->
            <div class="attendance-section">
                <h2 class="section-title">Attendance Overview</h2>
                
                <div class="attendance-header">
                    <div class="date-time-badges">
                        <span class="date-time-badge">
                            <i class="fe fe-calendar me-1"></i>
                            <span id="current-date"></span>
                        </span>
                        <span class="date-time-badge">
                            <i class="fe fe-clock me-1"></i>
                            <span id="current-time"></span>
                        </span>
                    </div>
                    
                    <div class="attendance-legend">
                        <span class="legend-item bg-success-transparent text-success">
                            <i class="fe fe-check-circle"></i> Present
                        </span>
                        <span class="legend-item bg-warning-transparent text-warning">
                            <i class="fe fe-umbrella"></i> Holiday
                        </span>
                        <span class="legend-item bg-primary-transparent text-primary">
                            <i class="fe fe-x-circle"></i> Approved
                        </span>
                        <span class="legend-item bg-danger-transparent text-danger">
                            <i class="fe fe-x-circle"></i> Absent
                        </span>
                    </div>
                </div>
                
                <div class="table-responsive hr-attlist">
                    <table class="table mb-0 text-nowrap text-md-nowrap table-bordered border custom-table" id="hr-attendance">
                        <thead>
                            <tr>
                                <th>Month</th>
                                {% for day in days_in_month %}
                                    <th class="attendance-th text-center">{{ day }}</th>
                                {% endfor %}
                                <th>Present</th>
                                <th>Absent</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for month, data in attendance_by_month.items %}
                                <tr>
                                    <td><strong>{{ month }}</strong></td>
                    
                                    {% for day in days_in_month %}
                                        <td class="attendance-td text-center
                                            {% for attendance in data.records %}
                                                {% if attendance.register.date.day|stringformat:"02d" == day %}
                                                    {% if attendance.status == "Present" %}
                                                        bg-success-transparent text-white
                                                    {% elif attendance.status == "Holiday" %}
                                                        bg-warning-transparent text-dark
                                                    {% elif attendance.status == "Absent" %}
                                                        {% if attendance.leave_status == "approved" %}
                                                            bg-primary-transparent text-white leave-cell"
                                                            data-date="{{ attendance.register.date|date:'d/m/Y' }}"
                                                            data-subject="{{ attendance.leave_subject }}"
                                                            data-reason="{{ attendance.leave_reason }}"
                                                            {% if attendance.leave_attachment %}data-attachment="{{ attendance.leave_attachment }}"{% endif %}
                                                            data-status="{{ attendance.leave_status }}"
                                                        {% elif attendance.leave_status %}
                                                            bg-warning-transparent text-dark leave-cell"
                                                            data-date="{{ attendance.register.date|date:'d/m/Y' }}"
                                                            data-subject="{{ attendance.leave_subject }}"
                                                            data-reason="{{ attendance.leave_reason }}"
                                                            {% if attendance.leave_attachment %}data-attachment="{{ attendance.leave_attachment }}"{% endif %}
                                                            data-status="{{ attendance.leave_status }}"
                                                        {% else %}
                                                            bg-danger-transparent text-white
                                                        {% endif %}
                                                    {% endif %}
                                                {% endif %}
                                            {% endfor %}
                                        ">
                                            {% for attendance in data.records %}
                                                {% if attendance.register.date.day|stringformat:"02d" == day %}
                                                    {% if attendance.status == "Present" %}
                                                        <span class="fe fe-check-circle text-success"></span>
                                                    {% elif attendance.status == "Holiday" %}
                                                        <span class="fe fe-umbrella text-warning"></span>
                                                    {% elif attendance.status == "Absent" %}
                                                        <span class="fe fe-x-circle text-danger"></span>
                                                    {% endif %}
                                                {% endif %}
                                            {% endfor %}
                                        </td>
                                    {% endfor %}
                    
                                    <td class="text-success fw-bold text-center">{{ data.total_present }}</td>
                                    <td class="text-danger fw-bold text-center">{{ data.total_absent }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                        <tfoot>
                            <tr>
                                <td><strong>Total</strong></td>
                                {% for day in days_in_month %}<td></td>{% endfor %}
                                <td class="text-success fw-bold text-center">{{ total_present }}</td>
                                <td class="text-danger fw-bold text-center">{{ total_absent }}</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>

        </div>
    </div>
    <!-- End::app-content -->

    <!-- Leave Request Modal -->
    <div class="modal fade" id="leaveModal" tabindex="-1" aria-labelledby="leaveModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content shadow-lg rounded-4 border-0">
        
        <!-- Modal Header -->
        <div class="modal-header text-white rounded-top-4" id="modalHeader">
            <h5 class="modal-title fw-bold" id="leaveModalLabel">
            <i class="fe fe-file-text me-2"></i> Leave Request Details
            </h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        
        <!-- Modal Body -->
        <div class="modal-body p-4">
            <!-- Date & Status Row -->
            <div class="row g-3 mb-4">
            <div class="col-md-6">
                <p class="mb-2 text-muted small fw-semibold">DATE</p>
                <div class="d-flex align-items-center gap-2 p-3 border rounded bg-light-subtle">
                <i class="fe fe-calendar text-primary"></i>
                <span class="fw-medium text-dark" id="modal-date">-</span>
                </div>
            </div>
            <div class="col-md-6">
                <p class="mb-2 text-muted small fw-semibold">STATUS</p>
                <div id="modal-status">
                <!-- Status badge will be loaded here -->
                </div>
            </div>
            </div>
            
            <!-- Subject -->
            <div class="mb-4">
            <p class="mb-2 text-muted small fw-semibold">SUBJECT</p>
            <div class="d-flex align-items-center gap-2 p-3 border rounded bg-light-subtle">
                <i class="fe fe-book text-primary"></i>
                <span class="fw-medium text-dark" id="modal-subject">-</span>
            </div>
            </div>
            
            <!-- Reason -->
            <div class="mb-4">
            <p class="mb-2 text-muted small fw-semibold">REASON</p>
            <div class="p-3 border rounded bg-light-subtle">
                <div class="d-flex gap-2">
                <i class="fe fe-message-square text-primary mt-1"></i>
                <div class="flex-grow-1">
                    <p class="text-dark mb-0" id="modal-reason">-</p>
                </div>
                </div>
            </div>
            </div>
            
            <!-- Minimal Attachment Section -->
            <div class="mb-4" id="attachmentSection" style="display: none;">
            <p class="mb-2 text-muted small fw-semibold">ATTACHMENT</p>
            <div class="d-flex align-items-center gap-3 p-3 border rounded bg-light-subtle" id="attachmentContent">
                <!-- Attachment will be loaded here -->
            </div>
            </div>
        </div>
        
        <!-- Modal Footer -->
        <div class="modal-footer border-0 pt-0">
            <button type="button" class="btn btn-outline-secondary btn-sm rounded-pill px-4" data-bs-dismiss="modal">
            <i class="fe fe-x me-1"></i> Close
            </button>
        </div>

        </div>
    </div>
    </div>

    {% comment %} {% include "admission/includes/subscription_modal.html" %} {% endcomment %}

    <script>
        function updateDateTime() {
            const now = new Date();
            
            // Format date as DD/MM/YYYY
            const dateStr = now.toLocaleDateString('en-GB', { day: '2-digit', month: '2-digit', year: 'numeric' });

            // Format time as HH:MM AM/PM
            const timeStr = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true });

            document.getElementById('current-date').textContent = dateStr;
            document.getElementById('current-time').textContent = timeStr;
        }

        // Update every second
        setInterval(updateDateTime, 1000);
        
        // Call function immediately on page load
        updateDateTime();
    </script>

    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const leaveCells = document.querySelectorAll(".leave-cell");

        leaveCells.forEach(cell => {
            cell.addEventListener("click", function() {
                const date = this.getAttribute("data-date") || "Not specified";
                const subject = this.getAttribute("data-subject") || "No subject provided";
                const reason = this.getAttribute("data-reason") || "No reason provided";
                const attachment = this.getAttribute("data-attachment");
                const status = this.getAttribute("data-status") || "unknown";

                // Set basic information
                document.getElementById("modal-date").textContent = date;
                document.getElementById("modal-subject").textContent = subject;
                document.getElementById("modal-reason").textContent = reason;

                // Set status badge
                const statusElement = document.getElementById("modal-status");
                let statusBadge = '';
                let headerColor = '';
                
                switch(status) {
                    case 'approved':
                        statusBadge = '<span class="badge bg-success-subtle text-success border border-success-subtle fs-12 px-3 py-2 w-100 text-center"><i class="fe fe-check-circle me-1"></i> Approved Leave</span>';
                        headerColor = 'bg-success';
                        break;
                    case 'pending':
                        statusBadge = '<span class="badge bg-warning-subtle text-warning border border-warning-subtle fs-12 px-3 py-2 w-100 text-center"><i class="fe fe-clock me-1"></i> Pending Review</span>';
                        headerColor = 'bg-warning';
                        break;
                    case 'rejected':
                        statusBadge = '<span class="badge bg-danger-subtle text-danger border border-danger-subtle fs-12 px-3 py-2 w-100 text-center"><i class="fe fe-x-circle me-1"></i> Rejected Leave</span>';
                        headerColor = 'bg-danger';
                        break;
                    default:
                        statusBadge = '<span class="badge bg-secondary-subtle text-secondary border border-secondary-subtle fs-12 px-3 py-2 w-100 text-center"><i class="fe fe-help-circle me-1"></i> Unknown Status</span>';
                        headerColor = 'bg-secondary';
                }
                
                statusElement.innerHTML = statusBadge;
                document.getElementById('modalHeader').className = `modal-header text-white rounded-top-4 ${headerColor}`;

                // Handle attachment
                const attachmentSection = document.getElementById("attachmentSection");
                const attachmentContent = document.getElementById("attachmentContent");
                
                if (attachment) {
                    const fileExtension = attachment.split('.').pop().toLowerCase();
                    const fileName = attachment.split('/').pop();
                    let attachmentHtml = '';
                    
                    if (['jpg', 'jpeg', 'png', 'gif', 'webp'].includes(fileExtension)) {
                        // Image file - compact preview
                        attachmentHtml = `
                            <div class="flex-shrink-0">
                                <div class="position-relative">
                                    <img src="${attachment}" class="rounded" style="width: 50px; height: 50px; object-fit: cover;" alt="Preview">
                                    <span class="position-absolute top-0 start-100 translate-middle badge bg-primary rounded-pill" style="font-size: 8px;">
                                        <i class="fe fe-image"></i>
                                    </span>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <p class="mb-1 small text-truncate fw-medium" style="max-width: 200px;">${fileName}</p>
                                <p class="mb-0 text-muted small">Image file</p>
                            </div>
                            <div class="flex-shrink-0">
                                <a href="${attachment}" target="_blank" class="btn btn-outline-primary btn-sm rounded-pill">
                                    <i class="fe fe-eye me-1"></i> View
                                </a>
                            </div>
                        `;
                    } else if (['pdf'].includes(fileExtension)) {
                        // PDF file
                        attachmentHtml = `
                            <div class="flex-shrink-0">
                                <div class="bg-danger rounded p-2 text-white d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;">
                                    <i class="fe fe-file-text fs-6"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <p class="mb-1 small text-truncate fw-medium" style="max-width: 200px;">${fileName}</p>
                                <p class="mb-0 text-muted small">PDF document</p>
                            </div>
                            <div class="flex-shrink-0">
                                <a href="${attachment}" target="_blank" class="btn btn-outline-danger btn-sm rounded-pill">
                                    <i class="fe fe-external-link me-1"></i> Open
                                </a>
                            </div>
                        `;
                    } else if (['doc', 'docx'].includes(fileExtension)) {
                        // Word document
                        attachmentHtml = `
                            <div class="flex-shrink-0">
                                <div class="bg-primary rounded p-2 text-white d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;">
                                    <i class="fe fe-file fs-6"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <p class="mb-1 small text-truncate fw-medium" style="max-width: 200px;">${fileName}</p>
                                <p class="mb-0 text-muted small">Word document</p>
                            </div>
                            <div class="flex-shrink-0">
                                <a href="${attachment}" target="_blank" class="btn btn-outline-primary btn-sm rounded-pill">
                                    <i class="fe fe-download me-1"></i> Download
                                </a>
                            </div>
                        `;
                    } else {
                        // Other file types
                        attachmentHtml = `
                            <div class="flex-shrink-0">
                                <div class="bg-secondary rounded p-2 text-white d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;">
                                    <i class="fe fe-file fs-6"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <p class="mb-1 small text-truncate fw-medium" style="max-width: 200px;">${fileName}</p>
                                <p class="mb-0 text-muted small">${fileExtension.toUpperCase()} file</p>
                            </div>
                            <div class="flex-shrink-0">
                                <a href="${attachment}" target="_blank" class="btn btn-outline-secondary btn-sm rounded-pill">
                                    <i class="fe fe-download me-1"></i> Download
                                </a>
                            </div>
                        `;
                    }
                    
                    attachmentContent.innerHTML = attachmentHtml;
                    attachmentSection.style.display = 'block';
                } else {
                    attachmentSection.style.display = 'none';
                }

                const leaveModal = new bootstrap.Modal(document.getElementById('leaveModal'));
                leaveModal.show();
            });
        });
    });
    </script>